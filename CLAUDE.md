# thudong-mcp-claude

MCP Server สำหรับ RAG ข้อมูลแบบสอบถาม "หลังการสอบภาคสนามธุดงค์"
- สถานที่: วัดป่าร้อยปีหลวงพ่อวิริยังค์ จ.ราชบุรี
- วันที่: 12-15 ธันวาคม พ.ศ. 2568

## Quick Stats
- ผู้ตอบ: 804 คน
- นักศึกษาสอบภาคสนาม: 690 คน (85.8%)
- คณะทำงาน: 105 คน (13.1%)
- ผู้สังเกตการณ์: 9 คน (1.1%)

## Data Structure

### 4 หมวดหลัก (32 คอลัมน์)

1. **ความรู้ที่ได้รับ** (8 ข้อ) - เฉพาะนักศึกษา
   - ประวัติหลวงพ่อ, เกร็ดธรรมะ, สมาธิ, การธุดงค์, ประโยชน์สมาธิ, ชวนะจิต, การนำไปใช้
   - Scale: มากที่สุด(5) → น้อยที่สุด(1)

2. **คุณธรรมจริยธรรม** (8 ข้อ) - เฉพาะนักศึกษา
   - เมตตา, เหตุผล, รับผิดชอบ, วินัย, อดทน, เสียสละ, ให้อภัย
   - Scale: มากที่สุด(5) → น้อยที่สุด(1)

3. **การจัดงาน** (6 ข้อ) - ทุกกลุ่ม
   - กำหนดการ, เส้นทาง, พี่เลี้ยง, ศาสนพิธี, พิธีกล่าวความรู้สึก, ตรงวัตถุประสงค์
   - Scale: พอใจมากที่สุด(5) → พอใจน้อยที่สุด(1)

4. **สิ่งอำนวยความสะดวก** (6 ข้อ) - ทุกกลุ่ม
   - ประชาสัมพันธ์, ประสานงาน, บรรยากาศ, ที่พัก, อาหาร, ห้องน้ำ
   - Scale: พอใจมากที่สุด(5) → พอใจน้อยที่สุด(1)

5. **ข้อความอิสระ** (2 ข้อ) - RAG Target
   - สิ่งที่ประทับใจมากที่สุด
   - สิ่งที่ควรปรับปรุง/ข้อเสนอแนะ

## Tech Stack
- Node.js + ES Modules
- @modelcontextprotocol/sdk
- better-sqlite3 + FTS5
- Transport: stdio / SSE

## File Locations
- Raw CSV: `data/Post-Thudong-Eval/WatPaRoiPee-2025.csv`
- Database: `db/thudong.db`
- Architecture: `ARCHITECTURE.md`

## Development Commands
```bash
npm run start          # Production (stdio)
npm run start:sse      # Production (SSE)
npm run dev            # Development with watch
npm run import         # Import CSV to database
npm run test:db        # Test database operations
```

## MCP Tools (6 tools)

### 1. `search_feedback`
ค้นหาข้อความจาก "ประทับใจ" และ "ข้อเสนอแนะ" ด้วย FTS5
- `query`: คำค้นหา (required)
- `type`: impressed | suggestion | all
- `limit`: จำนวนผลลัพธ์ (default: 10)

### 2. `get_statistics`
สรุปสถิติความพึงพอใจรายหมวด
- `category`: knowledge | moral | event | facility | all
- `respondent_type`: student | staff | observer | all

### 3. `get_survey_overview`
แสดงภาพรวมจำนวนผู้ตอบและข้อมูลสรุป

### 4. `get_improvements`
รวบรวมข้อเสนอแนะ/สิ่งที่ควรปรับปรุง
- `topic`: หัวข้อที่สนใจ (optional)
- `limit`: จำนวนผลลัพธ์ (default: 20)

### 5. `get_impressions`
รวบรวมสิ่งที่ประทับใจ
- `topic`: หัวข้อที่สนใจ (optional)
- `limit`: จำนวนผลลัพธ์ (default: 20)

### 6. `compare_groups`
เปรียบเทียบความพึงพอใจระหว่างกลุ่มผู้ตอบ
- `category`: event | facility (required)

## Docker

```bash
# Build
docker build -t thudong-mcp-claude .

# Run
docker run -i --rm thudong-mcp-claude

# SSE mode
docker run -p 3000:3000 thudong-mcp-claude node src/server-sse.js
```

## Example Prompts

### ภาพรวมและสถิติ
- "แสดงภาพรวมแบบสอบถามธุดงค์"
- "สรุปความพึงพอใจด้านสิ่งอำนวยความสะดวก"
- "สถิติความพึงพอใจหมวดการจัดงาน เฉพาะนักศึกษา"
- "คะแนนเฉลี่ยด้านความรู้ที่ได้รับทั้งหมด"

### ค้นหาความคิดเห็น
- "มีคนพูดถึงห้องน้ำอะไรบ้าง"
- "ค้นหาความเห็นเกี่ยวกับอาหาร"
- "หาข้อเสนอแนะที่เกี่ยวกับที่พัก"
- "ค้นหาสิ่งที่ประทับใจเกี่ยวกับพระอาจารย์"

### สิ่งประทับใจและข้อเสนอแนะ
- "รวมสิ่งที่ประทับใจเกี่ยวกับพี่เลี้ยง"
- "รวมข้อเสนอแนะเรื่องกำหนดการ"
- "แสดงสิ่งที่ประทับใจเกี่ยวกับการเดินธุดงค์ 10 อันดับแรก"
- "ข้อเสนอแนะเกี่ยวกับสถานที่มีอะไรบ้าง"

### เปรียบเทียบกลุ่ม
- "เปรียบเทียบความพึงพอใจด้านสิ่งอำนวยความสะดวก ระหว่างนักศึกษากับคณะทำงาน"
- "เปรียบเทียบคะแนนการจัดงานระหว่างกลุ่มผู้ตอบ"
- "กลุ่มไหนให้คะแนนอาหารสูงสุด"

### วิเคราะห์เชิงลึก
- "วิเคราะห์จุดแข็งและจุดอ่อนของการจัดงานธุดงค์"
- "สรุปประเด็นที่ต้องปรับปรุงสำหรับปีหน้า"
- "อะไรคือสิ่งที่ผู้เข้าร่วมประทับใจมากที่สุด"
- "มีปัญหาอะไรที่ถูกพูดถึงบ่อยที่สุด"

## Common Keywords for Search
- ประทับใจ: พี่เลี้ยง, สถานที่, อาหาร, พระอาจารย์, กัลยาณมิตร, การเดินธุดงค์, คณะทำงาน, ธรรมะ
- ข้อเสนอแนะ: ห้องน้ำ, คิว, หิน/พื้น, สุนัข, กำหนดการ, เต้นท์, ที่พัก, อาหาร, ประชาสัมพันธ์
